<div class="container">
  <div class="row">
    <div class="col-md-8 background-white-full ">
      <div class="padded-sides page-header">
        <h1>#<%= @offer.category.downcase %>: <%= @offer.title %></h1>
      </div>
      <div class="row margin-top-md padded-sides">
        <div class="col-md-4">
          <%= image_tag @offer.user.photo.url(:standard_face), class: "img-responsive bordered" %>
        </div>
        <div class="col-md-8">
          <dl class="dl-horizontal">
            <dt>Creator</dt>
            <dd><%= @offer.user.name.capitalize %></dd>
            <hr>
            <dt>Level</dt>
            <dd><%= @offer.seniority.capitalize %></dd>
            <hr>
            <dt>Description</dt>
            <dd><%= @offer.description %></dd>
            <dt>Avg Rating</dt>
            <dd><% @offer.average.times do %>
             <i class="fa fa-star" aria-hidden="true" style="color: yellow;" ></i>
              <% end %>

            <hr>
            <% if current_user == @offer.user %>
            <%= link_to "Edit offer", edit_offer_path(@offer), class: "btn btn-primary" %>
            <%= link_to "Delete offer", offer_path(@offer), method: :delete, data: { confirm: "Are you sure?" } %>
            <% else %>
            <%= link_to "Write a Review", new_offer_review_path(@offer), class: "btn btn-primary" %>
            <% end %>
          </dl>
        </div>
      </div>
      <div class="row margin-top-md">
        <div class="col-md-12" id="map">
        </div>
      </div>
    </div>
    <div>
      <% if current_user != @offer.user %>
        <div class="col-md-3 col-md-offset-1 margin-top-md">
          <%= simple_form_for [@offer, @booking] do |f| %>

          <div class="first-step-book">
            <div class="booking-span booking-span-red">
              <h3 >Make a booking!</h3>
            </div>
            <div class = "booking-span booking-span-white">
              <dl class="dl-horizontal text-left margin-top-sm">
                <dt>Price</dt>
                <dd><%= @offer.price %></dd>
                <dt>Commission</dt>
                <dd><%= @offer.charge_commission %></dd>
                <hr>
                <dt>Total</dt>
                <dd><%= @offer.charge_price %></dd>
              </dl>
            </div>
            <div class = "booking-span booking-span-white">
              <%= f.input :date, as: :string, placeholder: "2016-12-30", label: false, input_html: { class: 'datepicker' }  %>
              <%= link_to 'Book','#', class: 'btn btn-primary' ,id: "step-one" %>
            </div>
          </div>

          <div id="payment-form" class="second-step-book">
            <div class="booking-span booking-span-red">
              <h3>Your payment details</h3>
            </div>
            <div class="booking-span booking-span-white">
              <form class="form-inline">
                <div class="form-group">
                  <input type="text" class="form-control " placeholder="cardholder name">
                  <input type="text" class="form-control" placeholder="card number">
                  <input type="text" class="form-control" placeholder="expiry date">
                  <input type="text" class="form-control" placeholder="security code">
                </div>
              </form>
              <%= f.button :submit, "Book"%>
            </div>
          </div>
          <% end  %>
        </div>
      <% end %>
    </div>
  </div>

<% content_for(:after_js) do %>
  <%= javascript_tag do %>
  $(document).ready(function() {
  var handler = Gmaps.build('Google');
  handler.buildMap({ internal: { id: 'map' } }, function() {
  markers = handler.addMarkers(<%= raw @location_hash.to_json %>);
  handler.bounds.extendWith(markers);
  handler.fitMapToBounds();
  if (markers.length == 0) {
  handler.getMap().setZoom(2);
} else if (markers.length == 1) {
handler.getMap().setZoom(14);
}
});
});
<% end %>
<% end %>
